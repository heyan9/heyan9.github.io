<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥åœ£å·¥ä½œä½ Pro</title>
    <style>
        :root {
            --primary: #0066ff; /* çŸ¥ä¹è“ */
            --glass-bg: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.8);
            --text-main: #1a1a1a;
            --text-sub: #8590a6;
        }

        body {
            margin: 0;
            padding: 40px 20px;
            min-height: 100vh;
            background-color: #f6f8fa;
            background-image: 
                radial-gradient(at 10% 10%, rgba(0, 102, 255, 0.1) 0px, transparent 50%),
                radial-gradient(at 90% 90%, rgba(0, 200, 255, 0.1) 0px, transparent 50%);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        /* æ¯›ç»ç’ƒå¡ç‰‡é€šç”¨æ ·å¼ */
        .card {
            background: var(--glass-bg);
            backdrop-filter: saturate(180%) blur(20px);
            -webkit-backdrop-filter: saturate(180%) blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
            border-radius: 16px;
            padding: 24px;
            width: 100%;
            max-width: 600px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .card:hover {
            box-shadow: 0 12px 40px rgba(0, 102, 255, 0.1);
        }

        h2 {
            margin: 0 0 15px 0;
            font-size: 1.2rem;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon { font-size: 1.4rem; }

        /* æ¨¡å—1ï¼šè®¡æ•°å™¨ */
        .counter-section {
            text-align: center;
        }
        .count-num {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
            font-family: 'DIN Alternate', 'Courier New', sans-serif;
            margin: 10px 0;
            text-shadow: 0 4px 20px rgba(0, 102, 255, 0.3);
        }
        .btn-main {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
            transition: all 0.2s;
        }
        .btn-main:active { transform: scale(0.95); }

        /* æ¨¡å—2ï¼šæ—…æ¸¸ */
        .travel-display {
            font-size: 1.1rem;
            color: var(--text-main);
            padding: 15px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px dashed #ccc;
        }

        /* æ¨¡å—3ï¼šéšæœºç©ä¹ */
        .slot-machine {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff9900;
            margin-bottom: 15px;
            border: 1px solid #eee;
            min-height: 30px;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 8px 24px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }
        .btn-outline:hover { background: rgba(0, 102, 255, 0.05); }

        /* æ¨¡å—4ï¼šä¹¦å• */
        .book-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .book-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
        }
        .book-time { font-size: 0.8rem; color: var(--text-sub); }

        /* è¾“å…¥æ¡†é€šç”¨ */
        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        input[type="text"] {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            outline: none;
            background: rgba(255,255,255,0.9);
        }
        input[type="text"]:focus { border-color: var(--primary); }
        .btn-small {
            background: #f0f2f5;
            color: var(--text-main);
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            cursor: pointer;
        }
        .btn-small:hover { background: #e0e4e9; }

        /* IDé…ç½®åŒºåŸŸ */
        #config-area {
            font-size: 0.8rem;
            color: var(--text-sub);
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            border-top: 1px solid #ddd;
            width: 100%;
            max-width: 600px;
        }
        code {
            background: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            user-select: all;
            font-family: monospace;
            color: #d63031;
        }
        
        .loading-mask {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.9);
            z-index: 999;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column;
            transition: opacity 0.5s;
        }
    </style>
</head>
<body>

    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loading-mask" id="loadingMask">
        <h3>â˜ï¸ æ­£åœ¨è¿æ¥äº‘ç«¯æ•°æ®...</h3>
        <p style="font-size:0.9rem; color:#666">åˆæ¬¡åŠ è½½å¯èƒ½è¾ƒæ…¢</p>
    </div>

    <!-- æ¨¡å—1ï¼šç¥åœ£å·¥ä½œä½ -->
    <div class="card counter-section">
        <h2><span class="icon">âœ¨</span> ç¥åœ£å·¥ä½œä½</h2>
        <div class="count-num" id="countDisplay">0</div>
        <button class="btn-main" onclick="addCredit()">åŠŸå¾· +1</button>
    </div>

    <!-- æ¨¡å—2ï¼šæœ€è¿‘å»å“ªç©äº† -->
    <div class="card">
        <h2><span class="icon">âœˆï¸</span> æœ€è¿‘å»å“ªç©äº†ï¼Ÿ</h2>
        <div class="travel-display" id="travelDisplay">æš‚æ— è®°å½•</div>
        <div class="input-group">
            <input type="text" id="travelInput" placeholder="å¡«ç©ºï¼šä¾‹å¦‚ 'äº‘å—å¤§ç†'">
            <button class="btn-small" onclick="saveTravel()">æäº¤</button>
        </div>
    </div>

    <!-- æ¨¡å—3ï¼šå»ç©ä»€ä¹ˆï¼ˆæŠ½å–ï¼‰ -->
    <div class="card" style="text-align: center;">
        <h2><span class="icon">ğŸ²</span> ä¸‹ç­/å‘¨æœ«ç©ä»€ä¹ˆï¼Ÿ</h2>
        <div class="slot-machine" id="activityDisplay">?</div>
        <button class="btn-outline" onclick="spinActivity()">éšæœºæŠ½å–</button>
    </div>

    <!-- æ¨¡å—4ï¼šå·²é˜…ä¹¦å• -->
    <div class="card">
        <h2><span class="icon">ğŸ“š</span> é˜…è¯»è®°å½•</h2>
        <div class="input-group" style="margin-bottom: 15px;">
            <input type="text" id="bookInput" placeholder="è¾“å…¥ä¹¦åï¼Œå›è½¦æˆ–ç‚¹å‡»æäº¤">
            <button class="btn-small" onclick="addBook()">è®°å½•</button>
        </div>
        <ul class="book-list" id="bookList">
            <!-- ä¹¦å•åˆ—è¡¨ç”Ÿæˆåœ¨è¿™é‡Œ -->
        </ul>
    </div>

    <!-- ID é…ç½®è¯´æ˜ -->
    <div id="config-area">
        <p>ğŸ”´ <b>é‡è¦ï¼šå¤šè®¾å¤‡åŒæ­¥è®¾ç½®</b></p>
        <p>å½“å‰çš„äº‘ç«¯æ•°æ®IDæ˜¯ï¼š<br><code id="currentBlobId">æœªè®¾ç½®</code></p>
        <p>å¦‚æœä½ æƒ³åœ¨å¦ä¸€å°ç”µè„‘åŒæ­¥è¿™ä¸ªæ•°æ®ï¼Œè¯·å°†ä¸Šé¢çš„IDå¤åˆ¶ï¼Œ<br>å¹¶åœ¨ä»£ç ç¬¬ <b>183è¡Œ</b> å¡«å…¥è¯¥IDã€‚</p>
    </div>

    <script>
        // ==========================================
        // âš ï¸âš ï¸âš ï¸ ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯·ç•™ç©ºï¼ âš ï¸âš ï¸âš ï¸
        // ç­‰ç½‘é¡µè¿è¡Œç”Ÿæˆäº† ID åï¼Œå¦‚æœä½ æƒ³åœ¨æ‰‹æœº/å…¬å¸ç”µè„‘åŒæ­¥ï¼Œ
        // å°±æŠŠç”Ÿæˆçš„ ID å¡«åœ¨ä¸‹é¢å¼•å·é‡Œã€‚
        const MY_BLOB_ID = ""; 
        // ä¾‹å¦‚: const MY_BLOB_ID = "13156488-xxxx-xxxx-xxxx-xxxxxxxx";
        // ==========================================

        const API_URL = "https://jsonblob.com/api/jsonBlob";
        
        // é»˜è®¤æ•°æ®ç»“æ„
        let appState = {
            count: 0,
            travelLocation: "è¿˜æ²¡å¡«å†™å‘¢ï¼Œå¿«å»ç©å§ï¼",
            books: [] // { title: "ä¹¦å", date: "2023-10-01" }
        };

        // éšæœºæ´»åŠ¨åˆ—è¡¨
        const activities = [
            "ğŸ± æ‰“å°çƒ", "ğŸ¤ å”±æ­Œ", "ğŸ•¹ï¸ æ¸¸æˆå…", "ğŸ§‹ ä¹°å¥¶èŒ¶", 
            "ğŸ¬ çœ‹ç”µå½±", "ğŸº å–é…’", "ğŸ›ï¸ é€›è¡—", "ğŸï¸ æ—…æ¸¸", 
            "ğŸ° ä¹°è›‹ç³•", "â˜• å–å’–å•¡", "ğŸ”® ç©å¼¹ç ", "ğŸ® ç©ç”µç©"
        ];

        let currentId = MY_BLOB_ID;

        // åˆå§‹åŒ–
        async function init() {
            const mask = document.getElementById('loadingMask');
            
            if (!currentId) {
                // å¦‚æœæ²¡æœ‰IDï¼Œæ£€æŸ¥æœ¬åœ°ç¼“å­˜æœ‰æ²¡æœ‰ï¼ˆé˜²æ­¢åˆ·æ–°ä¸¢å¤±ï¼‰
                const localId = localStorage.getItem('holy_work_blob_id');
                if (localId) {
                    currentId = localId;
                    await loadData();
                } else {
                    // æ—¢æ²¡å¡«ä»£ç ï¼Œä¹Ÿæ²¡æœ¬åœ°ç¼“å­˜ -> è§†ä¸ºå…¨æ–°ç”¨æˆ·ï¼Œåˆ›å»ºæ–°äº‘ç«¯åº“
                    await createNewData();
                }
            } else {
                // ä»£ç é‡Œå¡«äº†ID -> ç›´æ¥åŠ è½½
                await loadData();
            }

            document.getElementById('currentBlobId').innerText = currentId;
            renderAll();
            mask.style.opacity = '0';
            setTimeout(() => mask.remove(), 500);
        }

        // åˆ›å»ºæ–°æ•°æ® (POST)
        async function createNewData() {
            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(appState)
                });
                // è·å–è¿”å›çš„ Location URL ä¸­çš„ UUID
                const location = res.headers.get('Location');
                currentId = location.split('/').pop();
                
                // ä¿å­˜åˆ°æœ¬åœ°é˜²æ­¢åˆ·æ–°ä¸¢å¤±
                localStorage.setItem('holy_work_blob_id', currentId);
                console.log("æ–°æ•°æ®åº“åˆ›å»ºæˆåŠŸ ID:", currentId);
            } catch (e) {
                alert("åˆ›å»ºäº‘ç«¯æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ");
            }
        }

        // è¯»å–æ•°æ® (GET)
        async function loadData() {
            try {
                const res = await fetch(`${API_URL}/${currentId}`);
                if (res.ok) {
                    appState = await res.json();
                }
            } catch (e) {
                console.error("åŠ è½½å¤±è´¥", e);
            }
        }

        // ä¿å­˜æ•°æ® (PUT)
        async function saveData() {
            if (!currentId) return;
            try {
                await fetch(`${API_URL}/${currentId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(appState)
                });
            } catch (e) {
                console.error("ä¿å­˜å¤±è´¥", e);
            }
        }

        // æ¸²æŸ“é¡µé¢
        function renderAll() {
            document.getElementById('countDisplay').innerText = appState.count;
            document.getElementById('travelDisplay').innerText = appState.travelLocation;
            
            const list = document.getElementById('bookList');
            list.innerHTML = "";
            // å€’åºæ˜¾ç¤ºï¼Œæ–°çš„åœ¨ä¸Šé¢
            [...appState.books].reverse().forEach(book => {
                const li = document.createElement('li');
                li.className = 'book-item';
                li.innerHTML = `<span>${book.title}</span> <span class="book-time">${book.date}</span>`;
                list.appendChild(li);
            });
        }

        // --- åŠŸèƒ½å‡½æ•° ---

        // 1. è®¡æ•°å™¨
        function addCredit() {
            appState.count++;
            document.getElementById('countDisplay').innerText = appState.count;
            // ç®€å•é˜²æŠ–ï¼Œå®é™…é¡¹ç›®ä¸­å¯ä»¥ç”¨ lodash debounce
            saveData(); 
        }

        // 2. æ—…æ¸¸è®°å½•
        function saveTravel() {
            const val = document.getElementById('travelInput').value;
            if(!val) return;
            appState.travelLocation = val;
            document.getElementById('travelInput').value = "";
            renderAll();
            saveData();
        }

        // 3. éšæœºæŠ½å–
        function spinActivity() {
            const display = document.getElementById('activityDisplay');
            let count = 0;
            const max = 20; // æ»šåŠ¨æ¬¡æ•°
            
            // æ»šåŠ¨åŠ¨ç”»
            const interval = setInterval(() => {
                display.innerText = activities[Math.floor(Math.random() * activities.length)];
                count++;
                if (count >= max) {
                    clearInterval(interval);
                    // æœ€ç»ˆç»“æœ
                    const final = activities[Math.floor(Math.random() * activities.length)];
                    display.innerText = "âœ¨ " + final + " âœ¨";
                }
            }, 50);
        }

        // 4. è®°å½•ä¹¦å•
        function addBook() {
            const input = document.getElementById('bookInput');
            const val = input.value;
            if(!val) return;

            const now = new Date();
            const dateStr = `${now.getMonth()+1}-${now.getDate()}`;

            appState.books.push({
                title: val,
                date: dateStr
            });

            input.value = "";
            renderAll();
            saveData();
        }

        init();
    </script>
</body>
</html>