<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>何岩Photo - Zootopia Edition</title>
    <style>
        :root {
            /* 疯狂动物城低饱和度色盘 */
            --judy-blue: #87A7CA;      /* 朱迪警服蓝 */
            --nick-green: #9DB8A1;     /* 尼克衬衫绿 */
            --carrot-gold: #EBC07E;    /* 胡萝卜暖金 */
            --city-grey: #D1D9E0;      /* 城市大象灰 */
            --white-glass: rgba(255, 255, 255, 0.4);
            --text-dark: #4A5568;
        }

        body {
            margin: 0; padding: 0;
            /* 模拟热带雨林区到冰川区的渐变 */
            background: linear-gradient(135deg, #eef2f3 0%, #cfd9df 100%);
            background-attachment: fixed;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* 顶层导航栏 - 深度毛玻璃 */
        header {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            padding: 12px 40px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        }

        .brand { display: flex; align-items: center; gap: 15px; text-decoration: none; }
        .brand img { height: 40px; border-radius: 50%; border: 3px solid #fff; }
        .brand span { font-size: 22px; font-weight: 800; color: var(--judy-blue); letter-spacing: 1.5px; }

        .nav-tabs { display: flex; gap: 12px; background: rgba(255,255,255,0.2); padding: 5px; border-radius: 30px; }
        .tab-btn {
            padding: 8px 22px; border-radius: 25px; cursor: pointer;
            font-size: 14px; font-weight: 600; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: var(--text-dark); border: none; background: transparent;
        }
        .tab-btn:hover { background: rgba(255,255,255,0.5); }
        /* 不同文件夹对应不同主题色 */
        .tab-btn.active[data-folder="img3"] { background: var(--nick-green); color: white; }
        .tab-btn.active[data-folder="img5"] { background: var(--judy-blue); color: white; }
        .tab-btn.active[data-folder="img6"] { background: var(--carrot-gold); color: white; }

        /* 内容展示区 */
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .gallery { column-count: 4; column-gap: 20px; }
        @media (max-width: 1100px) { .gallery { column-count: 3; } }
        @media (max-width: 750px) { .gallery { column-count: 2; } }

        .card {
            break-inside: avoid; margin-bottom: 20px; border-radius: 20px;
            background: var(--white-glass); border: 1px solid rgba(255,255,255,0.6);
            overflow: hidden; transition: 0.3s; cursor: zoom-in; position: relative;
            box-shadow: 0 10px 20px rgba(0,0,0,0.02);
        }
        .card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.08); }
        .card img, .card video { width: 100%; display: block; height: auto; transition: 0.5s; }
        
        .type-icon { 
            position: absolute; bottom: 12px; left: 12px; 
            background: rgba(255,255,255,0.8); padding: 4px 10px; 
            border-radius: 12px; font-size: 10px; font-weight: 700; color: var(--judy-blue);
        }

        /* 模态框沉浸式预览 */
        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(209, 217, 224, 0.85); backdrop-filter: blur(30px);
            z-index: 2000; justify-content: center; align-items: center;
        }
        #modal-content { position: relative; max-width: 90%; max-height: 85%; }
        #modal-img, #modal-video { max-width: 100%; max-height: 85vh; border-radius: 15px; box-shadow: 0 40px 100px rgba(0,0,0,0.2); display: none; }

        /* 导航按钮 */
        .nav-arrow {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.6); border: none; width: 55px; height: 55px;
            border-radius: 50%; font-size: 24px; cursor: pointer; transition: 0.3s;
            display: flex; justify-content: center; align-items: center; color: var(--text-dark);
        }
        .nav-arrow:hover { background: white; color: var(--judy-blue); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        #prev-btn { left: -80px; }
        #next-btn { right: -80px; }

        .close-btn { position: absolute; top: -50px; left: 0; color: var(--text-dark); cursor: pointer; font-size: 20px; font-weight: 700; }
        .down-btn { position: absolute; top: -50px; right: 0; background: var(--judy-blue); color: white; padding: 6px 20px; border-radius: 20px; text-decoration: none; font-size: 13px; font-weight: 600; }

        .loading { text-align: center; padding: 100px; font-weight: 600; color: var(--judy-blue); letter-spacing: 4px; animation: breathe 2s infinite; }
        @keyframes breathe { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }

        @media (max-width: 850px) { #prev-btn, #next-btn { display: none; } }
    </style>
</head>
<body>

<header>
    <a href="#" class="brand">
        <img src="./heyan.png" alt="Logo" onerror="this.src='https://via.placeholder.com/40?text=HY'">
        <span>何岩PHOTO</span>
    </a>
    <nav class="nav-tabs">
        <button class="tab-btn active" data-folder="img3" onclick="loadMedia('img3', this)">风景</button>
        <button class="tab-btn" data-folder="img5" onclick="loadMedia('img5', this)">主题</button>
        <button class="tab-btn" data-folder="img6" onclick="loadMedia('img6', this)">AIGC</button>
    </nav>
</header>

<div class="container">
    <div id="gallery" class="gallery"></div>
    <div id="loader" class="loading">WELCOME TO ZOOTOPIA...</div>
</div>

<div id="modal">
    <div id="modal-content">
        <span class="close-btn" onclick="closeModal()">✕ CLOSE</span>
        <a id="download-link" class="down-btn" download target="_blank">DOWNLOAD 原图</a>
        
        <button class="nav-arrow" id="prev-btn" onclick="navMedia(-1)">‹</button>
        <img id="modal-img" src="">
        <video id="modal-video" controls autoplay playsinline></video>
        <button class="nav-arrow" id="next-btn" onclick="navMedia(1)">›</button>
    </div>
</div>

<script>
    const GITHUB_CONFIG = {
        user: 'heyan9',
        repo: 'heyan9.github.io',
        branch: 'main' // 如果是 master 请修改
    };

    let currentMediaArray = [];
    let currentIndex = 0;

    // 核心加载函数
    async function loadMedia(folder, btn) {
        // UI 状态切换
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const gallery = document.getElementById('gallery');
        const loader = document.getElementById('loader');
        gallery.innerHTML = '';
        loader.style.display = 'block';
        currentMediaArray = [];

        try {
            const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.user}/${GITHUB_CONFIG.repo}/contents/${folder}?ref=${GITHUB_CONFIG.branch}`);
            const files = await response.json();

            if (!Array.isArray(files)) throw new Error("Folder not found");

            files.forEach(file => {
                const ext = file.name.split('.').pop().toLowerCase();
                const isImg = ['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(ext);
                const isVid = ['mp4', 'mov', 'webm'].includes(ext);

                if (isImg || isVid) {
                    const rawUrl = `https://raw.githubusercontent.com/${GITHUB_CONFIG.user}/${GITHUB_CONFIG.repo}/${GITHUB_CONFIG.branch}/${folder}/${file.name}`;
                    // 国内极速代理：Weserv
                    const optimizedUrl = isImg ? `https://images.weserv.nl/?url=${encodeURIComponent(rawUrl)}` : rawUrl;
                    
                    const mediaObj = { type: isImg ? 'img' : 'video', url: optimizedUrl, raw: rawUrl };
                    currentMediaArray.push(mediaObj);

                    const card = document.createElement('div');
                    card.className = 'card';
                    const idx = currentMediaArray.length - 1;

                    if (isImg) {
                        card.innerHTML = `<img src="${optimizedUrl}" loading="lazy">`;
                    } else {
                        card.innerHTML = `<span class="type-icon">VIDEO</span><video src="${optimizedUrl}" muted loop playsinline onmouseover="this.play()" onmouseout="this.pause()"></video>`;
                    }

                    card.onclick = () => openModal(idx);
                    gallery.appendChild(card);
                }
            });
            loader.style.display = 'none';
        } catch (error) {
            loader.innerHTML = "资源调取失败，请检查网络或文件夹名称";
        }
    }

    // 预览窗逻辑
    function openModal(index) {
        currentIndex = index;
        updateModalContent();
        document.getElementById('modal').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function updateModalContent() {
        const item = currentMediaArray[currentIndex];
        const imgEl = document.getElementById('modal-img');
        const videoEl = document.getElementById('modal-video');
        const dlLink = document.getElementById('download-link');

        imgEl.style.display = 'none';
        videoEl.style.display = 'none';
        videoEl.pause();
        videoEl.src = "";

        dlLink.href = item.raw; // 下载使用原图地址

        if (item.type === 'img') {
            imgEl.src = item.url;
            imgEl.style.display = 'block';
        } else {
            videoEl.src = item.url;
            videoEl.style.display = 'block';
            videoEl.play();
        }
    }

    function navMedia(step) {
        currentIndex = (currentIndex + step + currentMediaArray.length) % currentMediaArray.length;
        updateModalContent();
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
        document.getElementById('modal-video').pause();
        document.body.style.overflow = 'auto';
    }

    // 事件监听
    document.addEventListener('keydown', (e) => {
        if (document.getElementById('modal').style.display === 'flex') {
            if (e.key === "ArrowLeft") navMedia(-1);
            if (e.key === "ArrowRight") navMedia(1);
            if (e.key === "Escape") closeModal();
        }
    });

    document.getElementById('modal').onclick = (e) => {
        if (e.target.id === 'modal') closeModal();
    };

    // 初始加载
    loadMedia('img3', document.querySelector('.tab-btn'));
</script>

</body>
</html>