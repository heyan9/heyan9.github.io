<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>何岩Photo | Zootopia Media</title>
    <style>
        :root {
            --zootopia-blue: #007AFF;   /* 朱迪警服蓝 - 高饱和 */
            --zootopia-green: #28CD41;  /* 尼克衬衫绿 - 高饱和 */
            --zootopia-orange: #FF9500; /* 胡萝卜金 - 高饱和 */
            --city-grey: #8E8E93;
            --glass: rgba(255, 255, 255, 0.6);
        }

        body {
            margin: 0; padding: 0;
            background: #F2F2F7; /* 干净的浅灰背景 */
            font-family: -apple-system, system-ui, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* 极简导航栏 */
        header {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding: 10px 20px;
            display: flex; justify-content: space-between; align-items: center;
        }

        .logo-box img { height: 40px; display: block; } /* 纯净Logo，无圆圈 */

        .nav-wrap { display: flex; align-items: center; gap: 10px; }
        
        .tab {
            padding: 8px 16px; border-radius: 20px; border: none;
            font-size: 14px; font-weight: 700; cursor: pointer;
            background: rgba(0,0,0,0.05); color: var(--city-grey);
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 高饱和度分类配色 */
        .tab.active[data-f="img5"] { background: var(--zootopia-blue); color: white; }
        .tab.active[data-f="img3"] { background: var(--zootopia-green); color: white; }
        .tab.active[data-f="img6"] { background: var(--zootopia-orange); color: white; }

        .link-ext {
            background: #000; color: #fff; padding: 8px 14px;
            border-radius: 20px; text-decoration: none; font-size: 12px; font-weight: bold;
        }

        /* 真正的瀑布流容器 */
        .container { max-width: 1400px; margin: 15px auto; padding: 0 10px; }
        
        .masonry {
            column-count: 4;
            column-gap: 12px;
        }

        .media-item {
            break-inside: avoid;
            margin-bottom: 12px;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            cursor: zoom-in;
            transition: transform 0.3s;
            position: relative;
        }
        .media-item:hover { transform: translateY(-4px); }

        .media-item img, .media-item video {
            width: 100%;
            height: auto; /* 关键：保持原图比例，拒绝空缺 */
            display: block;
        }

        .v-badge {
            position: absolute; bottom: 8px; right: 8px;
            background: rgba(0,0,0,0.5); color: #fff;
            padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;
        }

        /* 沉浸式模态框 */
        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(25px);
            z-index: 2000; justify-content: center; align-items: center;
        }
        
        .m-content { position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        #m-img, #m-video { 
            max-width: 95%; max-height: 80vh; 
            border-radius: 8px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); 
            display: none; 
        }

        .m-nav {
            position: absolute; top: 50%; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; pointer-events: none;
        }
        .n-btn {
            width: 50px; height: 50px; background: rgba(0,0,0,0.05); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 24px;
            cursor: pointer; pointer-events: auto; border: none; transition: 0.2s;
        }
        .n-btn:hover { background: var(--zootopia-blue); color: #fff; }

        .m-top { position: absolute; top: 20px; width: 92%; display: flex; justify-content: space-between; align-items: center; }
        .m-close { font-size: 28px; cursor: pointer; color: #333; }
        .m-down { background: var(--zootopia-blue); color: #fff; padding: 8px 20px; border-radius: 20px; text-decoration: none; font-size: 14px; font-weight: bold; }

        /* 响应式适配 */
        @media (max-width: 1024px) { .masonry { column-count: 3; } }
        @media (max-width: 600px) {
            header { padding: 10px; flex-direction: column; gap: 12px; }
            .nav-wrap { width: 100%; justify-content: center; flex-wrap: wrap; }
            .masonry { column-count: 2; column-gap: 8px; }
            .media-item { margin-bottom: 8px; }
            .n-btn { display: none; } /* 手机端隐藏侧边按钮，依靠点击区域切换 */
            #m-img, #m-video { max-width: 100%; border-radius: 0; }
        }

        /* 手机端点击左右区域切换 */
        .touch-zone { position: absolute; top: 15%; width: 35%; height: 70%; z-index: 2001; }
        #left-zone { left: 0; }
        #right-zone { right: 0; }
    </style>
</head>
<body>

<header>
    <div class="logo-box"><img src="./heyan.png" alt="Logo"></div>
    <div class="nav-wrap">
        <button class="tab active" data-f="img5" onclick="load('img5', this)">主题</button>
        <button class="tab" data-f="img3" onclick="load('img3', this)">风景</button>
        <button class="tab" data-f="img6" onclick="load('img6', this)">AIGC</button>
        <a href="https://500px.com.cn/heyanw" target="_blank" class="link-ext">视觉中国 →</a>
    </div>
</header>

<div class="container">
    <div id="gallery" class="masonry"></div>
</div>

<!-- 模态框预览 -->
<div id="modal">
    <div class="m-content">
        <div class="m-top">
            <span class="m-close" onclick="hide()">✕</span>
            <a id="m-dl" class="m-down" download target="_blank">下载原图</a>
        </div>
        
        <div id="left-zone" class="touch-zone" onclick="nav(-1)"></div>
        <div id="right-zone" class="touch-zone" onclick="nav(1)"></div>

        <div class="m-nav">
            <button class="n-btn" onclick="nav(-1)">‹</button>
            <button class="n-btn" onclick="nav(1)">›</button>
        </div>

        <img id="m-img">
        <video id="m-video" controls autoplay playsinline></video>
    </div>
</div>

<script>
    const GH = { user: 'heyan9', repo: 'heyan9.github.io', branch: 'main' };
    let dataList = [];
    let idx = 0;

    async function load(folder, btn) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        btn.classList.add('active');
        
        const gallery = document.getElementById('gallery');
        gallery.innerHTML = '<div style="grid-column: 1/-1; text-align:center; padding: 50px; color:#999;">LOADING...</div>';
        dataList = [];

        try {
            const res = await fetch(`https://api.github.com/repos/${GH.user}/${GH.repo}/contents/${folder}?ref=${GH.branch}`);
            const files = await res.json();

            gallery.innerHTML = '';
            files.forEach(f => {
                const ext = f.name.split('.').pop().toLowerCase();
                const isI = ['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(ext);
                const isV = ['mp4', 'webm'].includes(ext);

                if (isI || isV) {
                    const raw = `https://raw.githubusercontent.com/${GH.user}/${GH.repo}/${GH.branch}/${folder}/${f.name}`;
                    const thumb = isI ? `https://images.weserv.nl/?url=${encodeURIComponent(raw)}` : raw;
                    
                    dataList.push({ type: isI ? 'i' : 'v', url: thumb, raw: raw });
                    
                    const el = document.createElement('div');
                    el.className = 'media-item';
                    const currentIdx = dataList.length - 1;

                    if (isI) {
                        el.innerHTML = `<img src="${thumb}" loading="lazy">`;
                    } else {
                        el.innerHTML = `<span class="v-badge">VIDEO</span><video src="${thumb}" muted loop playsinline onmouseover="this.play()" onmouseout="this.pause()"></video>`;
                    }
                    
                    el.onclick = () => show(currentIdx);
                    gallery.appendChild(el);
                }
            });
        } catch (e) { gallery.innerHTML = '加载失败'; }
    }

    function show(i) {
        idx = i;
        render();
        document.getElementById('modal').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function render() {
        const item = dataList[idx];
        const img = document.getElementById('m-img');
        const vid = document.getElementById('m-video');
        const dl = document.getElementById('m-dl');

        img.style.display = vid.style.display = 'none';
        vid.pause(); vid.src = "";
        dl.href = item.raw;

        if (item.type === 'i') {
            img.src = item.url; img.style.display = 'block';
        } else {
            vid.src = item.url; vid.style.display = 'block'; vid.play();
        }
    }

    function nav(step) {
        idx = (idx + step + dataList.length) % dataList.length;
        render();
    }

    function hide() {
        document.getElementById('modal').style.display = 'none';
        document.getElementById('m-video').pause();
        document.body.style.overflow = 'auto';
    }

    document.addEventListener('keydown', e => {
        if (document.getElementById('modal').style.display === 'flex') {
            if (e.key === "ArrowLeft") nav(-1);
            if (e.key === "ArrowRight") nav(1);
            if (e.key === "Escape") hide();
        }
    });

    // 初始加载主题 img5
    load('img5', document.querySelector('.tab[data-f="img5"]'));
</script>
</body>
</html>
